

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>NEO &mdash; GACODE 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/contentui.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/custom.css?v=a0fb6060" />

  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=f2a433a1"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/contentui.js"></script>
      <script>window.MathJax = {"tex": {"macros": {"qfilt": "{\\mathcal{Q}}", "exb": "{\\mathbf{E} \\hskip -1pt \\times \\hskip -1pt \\mathbf{B}}", "df": "{\\delta \\hskip -0.5pt f}", "vpar": "{{\\rm v}_\\parallel}", "vta": "{{\\rm v}_{ta}}", "bhat": "{\\textbf{b}}", "dv": "{d^{\\hskip 1pt 3} \\hskip -1pt {\\rm v}}", "jp": "{{\\cal J}_\\psi}", "B": "{\\mathbf{B}}", "bunit": "{B_\\mathrm{unit}}", "betae": "{\\beta_{e,{\\rm unit}}}", "dphi": "{\\delta \\hskip -1pt \\phi}", "dap": "{\\delta \\hskip -1pt A_\\parallel}", "dbp": "{\\delta \\hskip -1pt B_\\parallel}", "dphif": "{\\delta \\hskip -0.5pt \\widetilde{\\phi}}", "dapf": "{\\delta \\hskip -0.5pt \\widetilde{A}_\\parallel}", "dbpf": "{\\delta \\hskip -0.5pt \\widetilde{B}_\\parallel}", "na": "{N_\\alpha}", "nr": "{N_r}", "nx": "{N_\\xi}", "nux": "{N_u}", "nt": "{N_\\theta}", "ux": "{u}", "uxa": "{{\\ux}_a}", "uxb": "{{\\ux}_b}", "kpv": "{{\\bf k}_\\perp}", "md": "{m_\\mathrm{D}}", "Hf": "{\\widetilde{H}_a}", "Hk": "{H_{a,\\kpv}}", "Hkb": "{H_{b,\\kpv}}", "Hfb": "{\\widetilde{H}_b}", "pf": "{\\widetilde{\\Psi}_a}", "rhos": "{\\rho_s}", "hf": "{\\widetilde{h}_a}", "kperp": "{{\\mathbf k}_\\perp}", "qgb": "{Q_\\mathrm{GB}}", "kx": "{k_x^0}", "fwid": "{3.2in}", "nlc": "{\\texttt{nl03}\\xspace}", "rhof": "{\\rho_\\mathrm{f}}"}}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Parameters for input.neo" href="neo/neo_table.html" />
    <link rel="prev" title="References" href="zreferences.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            GACODE
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="README.html">Using GACODE</a></li>
<li class="toctree-l1"><a class="reference internal" href="setup.html">Prebuilt Environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="build.html">Build on your laptop</a></li>
<li class="toctree-l1"><a class="reference internal" href="zreferences.html">References</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Codes</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">NEO</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#quick-links">Quick links</a><ul>
<li class="toctree-l3"><a class="reference internal" href="neo/neo_table.html">Parameters for input.neo</a></li>
<li class="toctree-l3"><a class="reference internal" href="neo/neo_list.html">Alphabetical list for input.neo</a></li>
<li class="toctree-l3"><a class="reference internal" href="neo/outputs.html">NEO Output Files</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#data-input">Data input</a></li>
<li class="toctree-l2"><a class="reference internal" href="#data-output">Data output</a></li>
<li class="toctree-l2"><a class="reference internal" href="#normalization">Normalization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tgyro.html">TGYRO</a></li>
<li class="toctree-l1"><a class="reference internal" href="cgyro.html">CGYRO</a></li>
<li class="toctree-l1"><a class="reference internal" href="gyro.html">GYRO</a></li>
<li class="toctree-l1"><a class="reference internal" href="tglf.html">TGLF</a></li>
<li class="toctree-l1"><a class="reference internal" href="prgen.html">profiles_gen</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Physics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="geometry.html">Flux-Surface Geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="rotation.html">Rotation Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="input_gacode.html">input.gacode</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Misc</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="performance.html">Computational Performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="workshop.html">CGYRO Workshop 2022</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">GACODE</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">NEO</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/neo.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="neo">
<h1>NEO<a class="headerlink" href="#neo" title="Link to this heading"></a></h1>
<section id="quick-links">
<h2>Quick links<a class="headerlink" href="#quick-links" title="Link to this heading"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="neo/neo_table.html">Parameters for input.neo</a></li>
<li class="toctree-l1"><a class="reference internal" href="neo/neo_list.html">Alphabetical list for input.neo</a></li>
<li class="toctree-l1"><a class="reference internal" href="neo/outputs.html">NEO Output Files</a></li>
</ul>
</div>
<p>NEO <span id="id1">[<a class="reference internal" href="zreferences.html#id79" title="E.A. Belli and J. Candy. Kinetic calculation of neoclassical transport including self-consistent electron and impurity dynamics. Plasma Phys. Control. Fusion, 50:095010, 2008. doi:doi.org/10.1088/0741-3335/50/9/095010.">BC08</a>, <a class="reference internal" href="zreferences.html#id81" title="E.A. Belli and J. Candy. An Eulerian method for the solution of the multi-species drift-kinetic equation. Plasma Phys. Control. Fusion, 51:075018, 2009. doi:doi.org/10.1088/0741-3335/51/7/075018.">BC09</a>, <a class="reference internal" href="zreferences.html#id83" title="E.A. Belli and J. Candy. Full linearized Fokker-Planck collisions in neoclassical transport simulations. Plasma Phys. Control. Fusion, 54:015015, 2012. doi:doi.org/10.1088/0741-3335/54/1/015015.">BC12</a>]</span> is a multi-species drift-kinetic solver was developed by the ESL project as a practical tool for high accuracy neoclassical calculations.  NEO is an Eulerian code that solves the first-order (in the drift-ordering parameter <span class="math notranslate nohighlight">\(\rho_*=\rho_i/a \ll 1\)</span>) drift-kinetic-Poisson equations.  In NEO, no approximations beyond the drift-ordering are made.  The full linearized Fokker-Planck collision operator is used for the collision dynamics, with complete cross-species collisional coupling for arbitrary mass ratio and an arbitrary number of species.  General flux-surface shape, including up-down asymmetry, is treated.  In addition, full sonic rotation and centrifugal terms are retained.  NEO has been extensively benchamarked with analytic theories, as well as with NCLASS, over a wide range of parameters and in various asymptotic limits.</p>
<p>The equations solved in NEO complement those solved in gyrokinetic codes such as GYRO and CGYRO insofar as together they represent the complete first-order deviation of the plasma from a local Maxwellian.</p>
</section>
<section id="data-input">
<h2>Data input<a class="headerlink" href="#data-input" title="Link to this heading"></a></h2>
<p>The primary NEO input file is <a class="reference internal" href="neo/neo_table.html"><span class="doc">input.neo</span></a>.  Profile data can be optionally captured from  <a class="reference internal" href="input_gacode.html"><span class="doc">input.gacode</span></a>.</p>
<p>NEO can also be run using a subroutine interface. In this case, inputs and outputs are contained in a monolithic module file named neo_interface. The interface parameter name is formed by prepending neo_ and appending _in to the name of the corresponding input.neo parameter.</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="k">use </span><span class="n">neo_interface</span>
<span class="k">call </span><span class="n">neo_init</span>
<span class="c">! Set neo_interface inputs (e.g. neo_n_species_in = 2 ...)</span>
<span class="k">call </span><span class="n">neo_run</span>
<span class="c">! Get neo_interface outputs (e.g. jbs = neo_jpar_dke_out ...)</span>
</pre></div>
</div>
</section>
<section id="data-output">
<h2>Data output<a class="headerlink" href="#data-output" title="Link to this heading"></a></h2>
<p>A description of the NEO output files and output subroutine parameters is <a class="reference internal" href="neo/outputs.html"><span class="doc">here</span></a>.</p>
</section>
<section id="normalization">
<h2>Normalization<a class="headerlink" href="#normalization" title="Link to this heading"></a></h2>
<p>When run in local profile mode, the NEO normalizing length <span class="math notranslate nohighlight">\(a\)</span>, normalizing mass <span class="math notranslate nohighlight">\(m_{\rm norm}\)</span>, normalizing density <span class="math notranslate nohighlight">\(n_{\rm norm}\)</span>, normalizing temperature <span class="math notranslate nohighlight">\(T_{\rm norm}\)</span>, and normalizing velocity <span class="math notranslate nohighlight">\({\rm v}_{\rm norm} = \sqrt{T_{\rm norm}/m_{\rm norm}}\)</span> are arbitrary, since the input.neo parameters are set with respect to these and the output parameters are defined with respect to these. For experimental profiles, the normalizations are set as follows:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24.5%" />
<col style="width: 28.3%" />
<col style="width: 47.2%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Quantity</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Length</p></td>
<td><p><span class="math notranslate nohighlight">\(a\)</span></p></td>
<td><p>Minor radius</p></td>
</tr>
<tr class="row-odd"><td><p>Mass</p></td>
<td><p><span class="math notranslate nohighlight">\(m_{\rm norm} = m_{\rm D}\)</span></p></td>
<td><p>Mass of deuterium (3.3452e-27 kg)</p></td>
</tr>
<tr class="row-even"><td><p>Density</p></td>
<td><p><span class="math notranslate nohighlight">\(n_{\rm norm}(r)=n_{0,{\rm species 1}}\)</span></p></td>
<td><p>Local density of species 1</p></td>
</tr>
<tr class="row-odd"><td><p>Temperature</p></td>
<td><p><span class="math notranslate nohighlight">\(T_{\rm norm}(r)=T_{0,{\rm species 1}}\)</span></p></td>
<td><p>Local temperature of species 1</p></td>
</tr>
</tbody>
</table>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="zreferences.html" class="btn btn-neutral float-left" title="References" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="neo/neo_table.html" class="btn btn-neutral float-right" title="Parameters for input.neo" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2000-2025.
      <span class="lastupdated">Last updated on Apr 26, 2025.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>