<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Gyrokinetic Simulation in the 2000s &mdash; GACODE</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/contentui.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/contentui.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Gallery of classic GYRO images (circa 2003)" href="gyro_gallery.html" />
    <link rel="prev" title="GYRO verification and validation (pre 2010)" href="gyro_vv.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            GACODE
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Software</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../license.html">GACODE License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../download.html">Download and user agreement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../setup.html">Environment setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../build.html">Build from sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zreferences.html">References</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Codes</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../neo.html">NEO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tgyro.html">TGYRO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cgyro.html">CGYRO</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../gyro.html">GYRO</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../gyro.html#quick-links">Quick links</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="gyro_table.html">Tabular list for input.gyro</a></li>
<li class="toctree-l3"><a class="reference internal" href="gyro_list.html">Alphabetical list for input.gyro</a></li>
<li class="toctree-l3"><a class="reference internal" href="gyro_vv.html">GYRO verification and validation (pre 2010)</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Gyrokinetic Simulation in the 2000s</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#prehistory">Prehistory</a></li>
<li class="toctree-l4"><a class="reference internal" href="#design-history">Design History</a></li>
<li class="toctree-l4"><a class="reference internal" href="#yearly-publication-synopsis">Yearly Publication Synopsis</a></li>
<li class="toctree-l4"><a class="reference internal" href="#a-computational-science-and-user-perspective">A Computational Science and User Perspective</a></li>
<li class="toctree-l4"><a class="reference internal" href="#urban-legends">Urban Legends</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="gyro_gallery.html">Gallery of classic GYRO images (circa 2003)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gyro.html#overview">Overview</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tglf.html">TGLF</a></li>
<li class="toctree-l1"><a class="reference internal" href="../prgen.html">profiles_gen</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Physics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../geometry.html">FLUX-SURFACE GEOMETRY</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rotation.html">PLASMA ROTATION</a></li>
<li class="toctree-l1"><a class="reference internal" href="../input_gacode.html">input.gacode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc.html">Miscellaneous</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">GACODE</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../gyro.html">GYRO</a></li>
      <li class="breadcrumb-item active">Gyrokinetic Simulation in the 2000s</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/gyro/gyro_history.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="gyrokinetic-simulation-in-the-2000s">
<h1>Gyrokinetic Simulation in the 2000s<a class="headerlink" href="#gyrokinetic-simulation-in-the-2000s" title="Permalink to this heading"></a></h1>
<p><em>[This overview was written during the period 2006-2009]</em></p>
<hr class="docutils" />
<p>In the text below we describe the prehistory, history and present use of the GYRO code.  A broad spectrum of published code applications is summarized, and the key role played by GYRO within the US fusion program is clarified.  More historical details can be found in the Spring 2008 Issue of SciDAC review, whereas the
<a class="reference external" href="https://github.com/gafusion/doc/blob/master/manuals/gyro/gyro_technical_manual.pdf">Technical Manual</a>  provides a detailed description of the underlying equations and discretization schemes.</p>
<section id="prehistory">
<h2>Prehistory<a class="headerlink" href="#prehistory" title="Permalink to this heading"></a></h2>
<p>The use of gyrokinetic codes at General Atomics began in 1994 with the acquisition of the linear gyrokinetic stability code GSTOTAL <span id="id1">[<a class="reference internal" href="../zreferences.html#id86" title="M. Kotschenreuther, G. Rewoldt, and W.M. Tang. Comparison of initial value and eigenvalue codes for kinetic toroidal plasma instabilities. Comput. Phys. Commun., 88:128, 1995. doi:10.1016/0010-4655(95)00035-E.">KRT95</a>]</span>.  GSTOTAL was an Eulerian initial-value code with trapped and passing particles (ions and electrons) as well as collisional and electromagnetic physics.  GSTOTAL represented an enormous technical advance in simulation capability, comparable in significance to Kotschenreuther’s prior invention of the well-known <span class="math notranslate nohighlight">\(\delta f\)</span> method <span id="id2">[<a class="reference internal" href="../zreferences.html#id85" title="M. Kotschenreuther. Invited talk 9I4. Bull. Am. Phys. Soc., 33:2107, 1988.">Kot88</a>]</span> for particle simulation. The time-advance scheme in GSTOTAL was <em>fully implicit</em> and allowed use of timesteps much larger than those imposed by the electron parallel Courant limit. Historically speaking, GSTOTAL was the first step toward a practical <em>nonlinear</em> gyrokinetic code.  With the addition of plasma shaping and finite-<span class="math notranslate nohighlight">\(\delta B\)</span> effects, GSTOTAL evolved into the linear stability code GKS.  GKS has been routinely used in DIII-D experimental studies for over a decade.  Combined with results from nonlinear flux-tube gyrofluid simulations <span id="id3">[<a class="reference internal" href="../zreferences.html#id115" title="R.E. Waltz, G.R. Kerbel, and J. Milovich. Toroidal gyro-landau fluid model turbulence simulations in a nonlinear ballooning mode representation with radial modes. Phys. Plasmas, 1:2229, 1994.">WKM94</a>, <a class="reference internal" href="../zreferences.html#id116" title="R.E. Waltz, G.R. Kerbel, J. Milovich, and G.W. Hammett. Advances in the simulation of toroidal gyro-landau fluid model turbulence. Phys. Plasmas, 2:2408, 1995.">WKMH95</a>]</span>, GKS was crucial in the development of GLF23 <span id="id4">[<a class="reference internal" href="../zreferences.html#id117" title="R.E. Waltz, G.M. Staebler, W. Dorland, G.W. Hammett, M. Kotschenreuther, and J.A. Konings. A gyro-landau fluid transport model. Phys. Plasmas, 4:2482, 1997.">WSD+97</a>]</span>, one of the most popular transport models worldwide.</p>
<p>In what follows, we will draw a distinction between local and global simulations.  In this context, <em>local</em> means <em>flux-tube</em>.  Flux-tube simulations represent the <span class="math notranslate nohighlight">\(\rho_* \rightarrow 0\)</span> limit of global simulations, for which the transport scaling is purely gyroBohm <span id="id5">[<a class="reference internal" href="../zreferences.html#id27" title="J. Candy, R.E. Waltz, and W. Dorland. The local limit of global gyrokinetic simulations. Phys. Plasmas, 11:L25, 2004. doi:10.1063/1.1695358.">CWD04</a>]</span> <a class="footnote-reference brackets" href="#id79" id="id6" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>.   Here, <span class="math notranslate nohighlight">\(\rho_* = \rho_s/a\)</span> is the ratio of gyroradius to system size, with <span class="math notranslate nohighlight">\(\rho_s\)</span> the ion-sound Larmor radius, and <span class="math notranslate nohighlight">\(a\)</span> the plasma minor radius.</p>
<p>Nonlinear flux-tube ‘’gyrofluid’’ simulations by Beer, Dorland, Hammett, Snyder, Waltz and others provided the key physics discoveries in the mid-1990s, years before the same phenomena were observed in gyrokinetic simulations.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Gyrofluid simulations demonstrated that nonlinear, self-generated (zonal) flows control the nonlinear saturation of transport <span id="id7">[<a class="reference internal" href="../zreferences.html#id11" title="M.A. Beer and G.W. Hammett. Toroidal gyrofluid equations for simulations of tokamak turbulence. Phys. Plasmas, 3:4046, 1996.">BH96b</a>, <a class="reference internal" href="../zreferences.html#id49" title="W. Dorland and G.W. Hammett. Gyrofluid turbulence models with kinetic effects. Phys. Fluids B, 5:812, 1993.">DH93</a>, <a class="reference internal" href="../zreferences.html#id57" title="G.W. Hammett, M.A. Beer, J.C. Cummings, W. Dorland, W.W. Lee, H.E. Mynick, S.E. Parker, R.A. Santoro, M. Artun, H.P. Furth, T.S. Hahm, G. Rewoldt, W.M. Tang, R.E. Waltz, G.D. Kerbel, and J.L. Milovich. Advances in simulating tokamak turbulent transport. In Proceedings of the 15th IAEA Fusion Energy Conference, Seville, Spain, 1994, Vol III, p. 273. 1994.">HBC+94</a>, <a class="reference internal" href="../zreferences.html#id115" title="R.E. Waltz, G.R. Kerbel, and J. Milovich. Toroidal gyro-landau fluid model turbulence simulations in a nonlinear ballooning mode representation with radial modes. Phys. Plasmas, 1:2229, 1994.">WKM94</a>, <a class="reference internal" href="../zreferences.html#id116" title="R.E. Waltz, G.R. Kerbel, J. Milovich, and G.W. Hammett. Advances in the simulation of toroidal gyro-landau fluid model turbulence. Phys. Plasmas, 2:2408, 1995.">WKMH95</a>]</span>, and that equilibrium <span class="math notranslate nohighlight">\(\mathbf{E}\times\mathbf{B}\)</span> shear can quench transport if the shearing rates are comparable to maximum linear growth rates <span id="id8">[<a class="reference internal" href="../zreferences.html#id115" title="R.E. Waltz, G.R. Kerbel, and J. Milovich. Toroidal gyro-landau fluid model turbulence simulations in a nonlinear ballooning mode representation with radial modes. Phys. Plasmas, 1:2229, 1994.">WKM94</a>, <a class="reference internal" href="../zreferences.html#id116" title="R.E. Waltz, G.R. Kerbel, J. Milovich, and G.W. Hammett. Advances in the simulation of toroidal gyro-landau fluid model turbulence. Phys. Plasmas, 2:2408, 1995.">WKMH95</a>]</span>.</p>
</div>
<p>Nonlinear gyrofluid codes were the first to treat trapped electron <span id="id9">[<a class="reference internal" href="../zreferences.html#id10" title="M.A. Beer and G.W. Hammett. Bounce averaged trapped electron fluid equations for plasma turbulence. Phys. Plasmas, 3:4018, 1996.">BH96a</a>]</span> and electromagnetic <span id="id10">[<a class="reference internal" href="../zreferences.html#id94" title="P.B. Snyder and G.W. Hammett. Electromagnetic effects on plasma microturbulence and transport. Phys. Plasmas, 8:744, 2001.">SH01</a>]</span> turbulence.  The first major contribution from nonlinear <em>gyrokinetic</em> codes was the verification of the importance of Rosenbluth-Hinton (RH) residual flows <span id="id11">[<a class="reference internal" href="../zreferences.html#id93" title="M.N. Rosenbluth and F.L. Hinton. Poloidal flow driven by ion-temperature-gradient turbulence in tokamaks. Phys. Rev. Lett., 80:724, 1998.">RH98</a>]</span> as demonstrated by the flux-tube particle-in-cell (PIC) code PG3EQ <span id="id12">[<a class="reference internal" href="../zreferences.html#id47" title="A.M. Dimits, T.J. Williams, J.A. Byers, and B.I. Cohen. Scalings of ion-temperature-gradient-driven anomalous transport in tokamaks. Phys. Rev. Lett., 77:71, 1996.">DWBC96</a>]</span>. RH flows were shown to give rise to an upshift in the nonlinear threshold for ITG-ae <a class="footnote-reference brackets" href="#id80" id="id13" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a> turbulence. The nonlinear upshift was later named the <em>Dimits shift</em> after its discoverer.  The difficulty in properly treating this residual in gyrofluid models was one motivating factor for a switch from gyrofluid to gyrokinetic simulation.  To this end, by building upon the GSTOTAL implicit scheme, Dorland and co-workers created the <strong>nonlinear Eulerian gyrokinetic code</strong> GS2 <span id="id14">[<a class="reference internal" href="../zreferences.html#id50" title="W. Dorland, F. Jenko, M. Kotschenreuther, and B.N. Rogers. Electron temperature gradient turbulence. Phys. Rev. Lett., 85:5579, 2000.">DJKR00</a>]</span>.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>GS2 <span id="id15">[<a class="reference internal" href="../zreferences.html#id50" title="W. Dorland, F. Jenko, M. Kotschenreuther, and B.N. Rogers. Electron temperature gradient turbulence. Phys. Rev. Lett., 85:5579, 2000.">DJKR00</a>]</span> was the first nonlinear gyrokinetic code to include the crucial nonadiabatic electron dynamics required for trapped electron mode and electromagnetic physics.</p>
</div>
</section>
<section id="design-history">
<h2>Design History<a class="headerlink" href="#design-history" title="Permalink to this heading"></a></h2>
<p>Development of GYRO started in 1999.  The primary goal was to generalize GS2 by retaining profile-variation effects to allow, in principle, deviations from pure gyroBohm scaling.  The numerical methods for GYRO were initially patterned after GS2 wherever possible.  In the end, many significant departures from GS2 were required to meet the GYRO design target <em>and</em> to simultaneously increase computational efficiency.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>By 2001, GYRO had the ability to operate either globally using Dirichlet (zero-value) radial boundary conditions, or locally using flux-tube (periodic) boundary conditions.</p>
</div>
<p>An implicit-explicit Runge-Kutta (IMEX-RK) integrator was eventually added to overcome the electrostatic-Alfvén wave Courant limit, which can severely limit the timestep for large-domain simulations.  Independently, a novel poloidal discretization scheme solved the <strong>Ampere cancellation problem</strong> <span id="id16">[<a class="reference internal" href="../zreferences.html#id25" title="J. Candy and R.E. Waltz. An Eulerian gyrokinetic-Maxwell solver. J. Comput. Phys., 186:545, 2003. doi:10.1016/S0021-9991(03)00079-2.">CW03b</a>]</span>.  The latter pathology hampered electromagnetic PIC simulation for over a decade.  To date, only a single PIC code <span id="id17">[<a class="reference internal" href="../zreferences.html#id45" title="Y. Chen, S.E. Parker, B.I. Cohen, A.M. Dimits, W.M. Nevins, D. Schumaker, V.K. Decyk, and J.N. Leboeuf. Simulations of turbulent transport with kinetic electrons and electromagnetic effects. Nucl. Fusion, 43:1121, 2003.">CPC+03</a>]</span> has successfully treated finite-<span class="math notranslate nohighlight">\(\beta\)</span> fluctuations with full electron dynamics, and only after implementing an analog of the GYRO scheme.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>By 2002, GYRO <span id="id18">[<a class="reference internal" href="../zreferences.html#id25" title="J. Candy and R.E. Waltz. An Eulerian gyrokinetic-Maxwell solver. J. Comput. Phys., 186:545, 2003. doi:10.1016/S0021-9991(03)00079-2.">CW03b</a>]</span> achieved robust operation with its physics design targets.  This was demonstrated <span id="id19">[<a class="reference internal" href="../zreferences.html#id26" title="J. Candy and R.E. Waltz. Anomalous transport scaling in the DIII-D tokamak matched by supercomputer simulation. Phys. Rev. Lett., 91:045001, 2003. doi:10.1103/PhysRevLett.91.045001.">CW03a</a>]</span> in realistic simulations of dimensionally similar Bohm scaled DIII-D L-mode discharges.</p>
</div>
</section>
<section id="yearly-publication-synopsis">
<h2>Yearly Publication Synopsis<a class="headerlink" href="#yearly-publication-synopsis" title="Permalink to this heading"></a></h2>
<section id="id20">
<h3>2002<a class="headerlink" href="#id20" title="Permalink to this heading"></a></h3>
<p>The first application of GYRO was to use the global capability with adiabatic electons to systematically examine the breaking of gyroBohm scaling (including what are now called, somewhat ambiguously, <em>nonlocal</em> or <em>turbulence spreading</em> effects) via profile variation <span id="id21">[<a class="reference internal" href="../zreferences.html#id120" title="R.E. Waltz, J. Candy, and M.N. Rosenbluth. Gyrokinetic turbulence simulation of profile shear stabilization and broken gyrobohm scaling. Phys. Plasmas, 9:1938, 2002.">WCR02</a>]</span>.</p>
</section>
<section id="id22">
<h3>2003<a class="headerlink" href="#id22" title="Permalink to this heading"></a></h3>
<p>GYRO numerical algorithms were documented <span id="id23">[<a class="reference internal" href="../zreferences.html#id25" title="J. Candy and R.E. Waltz. An Eulerian gyrokinetic-Maxwell solver. J. Comput. Phys., 186:545, 2003. doi:10.1016/S0021-9991(03)00079-2.">CW03b</a>]</span>, although publication was significantly delayed after the first submission was lost in transit.  A significant amount of linear and nonlinear benchmark data related to the Cyclone base case was given, as were parameter scans for nonlinear electromagnetic variants of the Cyclone case.  On the experimental side, simulations of DIII-D L-mode discharges were shown to match experimental power flow data within error bars <span id="id24">[<a class="reference internal" href="../zreferences.html#id26" title="J. Candy and R.E. Waltz. Anomalous transport scaling in the DIII-D tokamak matched by supercomputer simulation. Phys. Rev. Lett., 91:045001, 2003. doi:10.1103/PhysRevLett.91.045001.">CW03a</a>]</span> on the ion temperature gradient.  These simulations were physically realistic, and included finite-<span class="math notranslate nohighlight">\(\beta\)</span> effects, and collisional electron physics at real mass ratio, equilibrium <span class="math notranslate nohighlight">\(\mathbf{E}\times\mathbf{B}\)</span> and profile shearing, as well as plasma shaping.</p>
</section>
<section id="id25">
<h3>2004<a class="headerlink" href="#id25" title="Permalink to this heading"></a></h3>
<p>Turbulent dynamos in the tokamak current-voltage relation <span id="id26">[<a class="reference internal" href="../zreferences.html#id59" title="F.L. Hinton, R.E. Waltz, and J. Candy. Effect of electromagnetic turbulence in the neoclassical Ohm's law. Phys. Plasmas, 11:2433, 2004.">HWC04</a>]</span> were studied, showing that the turbulent dynamo EMF drives large current density corrugations at low-order rational surfaces, but little net current.  In other work, we attempted to correct misunderstanding generated by a highly-publicized global <span class="math notranslate nohighlight">\(\rho_*\)</span>-scan <span id="id27">[<a class="reference internal" href="../zreferences.html#id89" title="Z. Lin, S. Ethier, T.S. Hahm, and W.M. Tang. Size scaling of turbulent transport in magnetically confined plasmas. Phys. Rev. Lett., 88:195004, 2002.">LEHT02</a>]</span> with highly artificial profiles.  The single scan appeared to suggest a universal range in <span class="math notranslate nohighlight">\(\rho_*\)</span> marking the transition from Bohm to gyroBohm scaling.  GYRO work established that the transition <strong>cannot</strong> be characterized by a universal curve; rather, the transition is highly dependent on the profile shape <span id="id28">[<a class="reference internal" href="../zreferences.html#id27" title="J. Candy, R.E. Waltz, and W. Dorland. The local limit of global gyrokinetic simulations. Phys. Plasmas, 11:L25, 2004. doi:10.1063/1.1695358.">CWD04</a>]</span> <a class="footnote-reference brackets" href="#id81" id="id29" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a>.</p>
<p>During this period, there were persistent claims from certain groups that transport is depressed near a <span class="math notranslate nohighlight">\(q_\mathrm{min}\)</span>-surface where there is a <em>gap</em> in singular surfaces <span id="id30">[<a class="reference internal" href="../zreferences.html#id84" title="Y. Kishimoto, J.-Y. Kim, W. Horton, T. Tajima, M.J. LeBrun, S.A. Dettrick, J.Q. Li, and S. Shirai. Discontinuity model for internal transport formation in reversed magnetic shear plasmas. Nucl. Fusion, 40:667, 2000.">KKH+00</a>]</span>.  Global GYRO simulations indicated that transport flows tends to vary monotonically across <span class="math notranslate nohighlight">\(q_\mathrm{min}\)</span> surfaces <span id="id31">[<a class="reference internal" href="../zreferences.html#id28" title="J. Candy, R.E. Waltz, and M.N. Rosenbluth. Smooothness of turbulent transport across a minimum-$q$ surface. Phys. Plasmas, 11:1879, 2004.">CWR04</a>]</span> (as expected from linear theory and flux-tube gyrofluid simulations <span id="id32">[<a class="reference internal" href="../zreferences.html#id115" title="R.E. Waltz, G.R. Kerbel, and J. Milovich. Toroidal gyro-landau fluid model turbulence simulations in a nonlinear ballooning mode representation with radial modes. Phys. Plasmas, 1:2229, 1994.">WKM94</a>, <a class="reference internal" href="../zreferences.html#id116" title="R.E. Waltz, G.R. Kerbel, J. Milovich, and G.W. Hammett. Advances in the simulation of toroidal gyro-landau fluid model turbulence. Phys. Plasmas, 2:2408, 1995.">WKMH95</a>]</span>) due to the appearance of nonresonant modes. These modes are absent in some simplified gyrofluid simulations which at first appeared to confirm the barrier hypothesis.</p>
</section>
<section id="id33">
<h3>2005<a class="headerlink" href="#id33" title="Permalink to this heading"></a></h3>
<p>The first systematic gyrokinetic study of particle transport and impurity dynamics was made with GYRO as thesis work for a UCSD graduate student.   In particular, temperature-gradient-induced particle pinches, thermal and energetic helium ash transport, differential flows in D-T plasmas, and collisional effects on particle pinches were examined <span id="id34">[<a class="reference internal" href="../zreferences.html#id51" title="C. Estrada-Mila, J. Candy, and R.E. Waltz. Gyrokinetic simulations of ion and impurity transport. Phys. Plasmas, 12:022305, 2005.">EMCW05</a>]</span>.  Scans in temperature and density gradients (moving from ITG- to TEM-dominated transport), <span class="math notranslate nohighlight">\(T_i/T_e\)</span>, <span class="math notranslate nohighlight">\(\mathbf{E}\times\mathbf{B}\)</span> and parallel velocity shear <span id="id35">[<a class="reference internal" href="../zreferences.html#id79" title="J.E. Kinsey, R.E. Waltz, and J. Candy. Nonlinear gyrokinetic turbulence simulations of E×B shear quenching of transport. Phys. Plasmas, 12:062302, 2005.">KWC05</a>]</span> were also published.</p>
<p>A detailed study of the beta dependence of electron and ion transport was made <span id="id36">[<a class="reference internal" href="../zreferences.html#id29" title="J. Candy. Beta scaling of transport in microturbulence simulations. Phys. Plasmas, 12:072307, 2005.">Can05</a>]</span>.  This latter work documents the so-called <em>beta runaway</em> phenomenon, which occurs at about half of the MHD crictical beta; as of Winter 2009, it remains an unsolved problem in gyrokinetics.</p>
<p>Using a profile feedback scheme, simulations starting with DIII-D L-mode profiles successfully (and slightly) relaxed the experimental temperature and density so that simulated power flows matched experimental ones <span id="id37">[<a class="reference internal" href="../zreferences.html#id121" title="R.E. Waltz, J. Candy, F.L. Hinton, C. Estrada-Mila, and J.E. Kinsey. Advances in comprehensive simulations of transport in tokamaks. Nucl. Fusion, 45:741, 2005.">WCH+05</a>]</span>.  This sort of capability was an early landmark in the development of a more comprehensive steady-state gyrokinetic transport code.  GYRO simulations also yielded several examples of nonlocal transport <span id="id38">[<a class="reference internal" href="../zreferences.html#id123" title="R.E. Waltz. Rho-star scaling and physically realistic gyrokinetic simulations of transport in DIII-D. Fus. Sci. Tech., 48:1051, 2005.">Wal05</a>, <a class="reference internal" href="../zreferences.html#id122" title="R.E. Waltz and J. Candy. Heuristic theory of nonlocally broken gyrobohm scaling. Phys. Plasmas, 12:072303, 2005.">WC05</a>]</span>; in particular, turbulence <em>draining</em> from unstable to less unstable (or stable) regions.  At this time, the detailed radial structure of nonlinear profile perturbations was also explored: persistent (i.e., time-averaged) structure tied to rational surfaces <span id="id39">[<a class="reference internal" href="../zreferences.html#id29" title="J. Candy. Beta scaling of transport in microturbulence simulations. Phys. Plasmas, 12:072307, 2005.">Can05</a>, <a class="reference internal" href="../zreferences.html#id121" title="R.E. Waltz, J. Candy, F.L. Hinton, C. Estrada-Mila, and J.E. Kinsey. Advances in comprehensive simulations of transport in tokamaks. Nucl. Fusion, 45:741, 2005.">WCH+05</a>]</span> was found when electrons are kinetic.  These <em>corrugation</em> structures are electrostatic in nature, and most pronounced for lower-order surfaces</p>
<div class="math notranslate nohighlight">
\[q = \frac{1}{1}, \frac{2}{1}, \frac{3}{1}, \ldots \; ,\]</div>
<p>and are weaker for successively higher-order surfaces, like</p>
<div class="math notranslate nohighlight">
\[q = \frac{1}{2}, \frac{3}{2}, \frac{5}{2}, \ldots \; .\]</div>
<p>The width of these structures is on the order of a few ion gyroradii.</p>
</section>
<section id="id40">
<h3>2006<a class="headerlink" href="#id40" title="Permalink to this heading"></a></h3>
<p>GYRO results showed that ITG/TEM turbulence could induce the transport of energetic fusion alpha particles <span id="id41">[<a class="reference internal" href="../zreferences.html#id53" title="C. Estrada-Mila, J. Candy, and R.E. Waltz. Turbulent transport of alpha particles and helium ash in reactor plasmas. Phys. Plasmas, 13:112303, 2006.">EMCW06b</a>]</span>.  Systematic safety factor, magnetic shear, and MHD alpha parameter scans <span id="id42">[<a class="reference internal" href="../zreferences.html#id80" title="J.E. Kinsey, R.E. Waltz, and J. Candy. The effect of safety factor and magnetic shear on turbulent transport in nonlinear gyrokinetic simulations. Phys. Plasmas, 13:022305, 2006.">KWC06</a>]</span> were carried out.  Theory and simulations of gyrokinetic turbulent heating <span id="id43">[<a class="reference internal" href="../zreferences.html#id60" title="F.L. Hinton and R.E. Waltz. Gyrokinetic turbulent heating. Phys. Plasmas, 13:102301, 2006.">HW06</a>]</span> were published.  GYRO simulations which perfectly project profiles from dimensionally similar DIII-D discharges verified that the L-modes did indeed have Bohm scaling, and that the experimentally-inferred gyroBohm scaling in some H-modes was actually due to experimental profile <em>dissimilarity</em> <span id="id44">[<a class="reference internal" href="../zreferences.html#id124" title="R.E. Waltz, J. Candy, and C.C. Petty. Projected profile similarity in gyrokinetic simulations of Bohm and gyroBohm scaled DIII-D L and H modes. Phys. Plasmas, 13:072304, 2006.">WCP06</a>]</span>.   The predicted <em>profile corrugations</em> in the electron temperature gradient were observed in <span class="math notranslate nohighlight">\(q_\mathrm{min} = 2\)</span> DIII-D discharges, and the attending <span class="math notranslate nohighlight">\(\mathbf{E}\times\mathbf{B}\)</span> shear layer is believed to be the trigger for low-power reversed shear ITB formation <span id="id45">[<a class="reference internal" href="../zreferences.html#id125" title="R.E. Waltz, M.E. Austin, K.H. Burrell, and J. Candy. Gyrokinetic simulations of off-axis minimum-q profile corrugations. Phys. Plasmas, 12:052301, 2006.">WABC06</a>]</span>.  Density peaking via a particle pinch was demonstrated for a DIII-D L-mode plasma <span id="id46">[<a class="reference internal" href="../zreferences.html#id52" title="C. Estrada-Mila, J. Candy, and R.E. Waltz. Density peaking and turbulent pinch in DIII-D discharges. Phys. Plasmas, 13:074505, 2006.">EMCW06a</a>]</span>.</p>
<p>In studies relating to the foundation of gyrokinetic theory, the connection between velocity-space resolution, entropy production and conservation, and numerical dissipation was rigorously demonstrated <span id="id47">[<a class="reference internal" href="../zreferences.html#id30" title="J. Candy and R.E. Waltz. Velocity-space resolution, entropy production and upwind dissipation in Eulerian gyrokinetic simulations. Phys. Plasmas, 13:032310, 2006.">CW06</a>]</span>, and the parallel nonlinearity was shown to be asymptotically subdominant (as required by the gyrokinetic ordering) to have a negligible effect on energy transport for experimentally-relevant discharges <span id="id48">[<a class="reference internal" href="../zreferences.html#id31" title="J. Candy, R.E. Waltz, S.E. Parker, and Y. Chen. Relevance of the parallel nonlinearity in gyrokinetic simulations of tokamak plasmas. Phys. Plasmas, 13:074501, 2006.">CWPC06</a>]</span>.</p>
</section>
<section id="id49">
<h3>2007<a class="headerlink" href="#id49" title="Permalink to this heading"></a></h3>
<p>The capability to simultaneously treat electron and ion gyroaverages, and thus to perform fully-coupled, multi-scale ITG-ETG simulations, was added to GYRO <span id="id50">[<a class="reference internal" href="../zreferences.html#id34" title="J. Candy, R.E. Waltz, M.R. Fahey, and C. Holland. Plasma microturbulence simulation of instabilities at highly disparate scales. J. Phys: Conf. Series, 78:012008, 2007.">CWFH07a</a>]</span>.  The results of these simulations allowed us to make significant progress on the problem of electron-scale transport using coupled ITG/TEM-ETG turbulence at a reduced ion-to-electron mass ratio.  We were able to</p>
<ul class="simple">
<li><p>identify the failure of the popular adiabatic ion model of ETG transport <span id="id51">[<a class="reference internal" href="../zreferences.html#id33" title="J. Candy, R.E. Waltz, M.R. Fahey, and C. Holland. The effect of ion-scale dynamics on electron-temperature-gradient turbulence. Plasma Phys. Control. Fusion, 49:1209, 2007.">CWFH07b</a>]</span>,</p></li>
<li><p>demonstrate the isotropy of short-wavelength fluctuations <span id="id52">[<a class="reference internal" href="../zreferences.html#id33" title="J. Candy, R.E. Waltz, M.R. Fahey, and C. Holland. The effect of ion-scale dynamics on electron-temperature-gradient turbulence. Plasma Phys. Control. Fusion, 49:1209, 2007.">CWFH07b</a>, <a class="reference internal" href="../zreferences.html#id126" title="R.E. Waltz, J. Candy, and M. Fahey. Coupled ion temperature gradient and trapped electron mode to electron temperature gradient mode gyrokinetic simulations. Phys. Plasmas, 14:056116, 2007.">WCF07</a>]</span> in the presence of long-wavelength ITG/TEM instabilities,</p></li>
<li><p>demonstrate the potential for ITG/TEM-scale instabilities to drive ETG transport in ETG-stable regimes <span id="id53">[<a class="reference internal" href="../zreferences.html#id126" title="R.E. Waltz, J. Candy, and M. Fahey. Coupled ion temperature gradient and trapped electron mode to electron temperature gradient mode gyrokinetic simulations. Phys. Plasmas, 14:056116, 2007.">WCF07</a>]</span>,</p></li>
<li><p>demonstrate the potential for ETG transport to decouple from ITG transport in regimes where both are unstable <span id="id54">[<a class="reference internal" href="../zreferences.html#id126" title="R.E. Waltz, J. Candy, and M. Fahey. Coupled ion temperature gradient and trapped electron mode to electron temperature gradient mode gyrokinetic simulations. Phys. Plasmas, 14:056116, 2007.">WCF07</a>]</span>,</p></li>
<li><p>demonstrate the reduction of ETG-transport by increasing ITG/TEM free energy <span id="id55">[<a class="reference internal" href="../zreferences.html#id34" title="J. Candy, R.E. Waltz, M.R. Fahey, and C. Holland. Plasma microturbulence simulation of instabilities at highly disparate scales. J. Phys: Conf. Series, 78:012008, 2007.">CWFH07a</a>]</span>,</p></li>
<li><p>demonstrate a <em>universal range</em> for ETG transport <span id="id56">[<a class="reference internal" href="../zreferences.html#id34" title="J. Candy, R.E. Waltz, M.R. Fahey, and C. Holland. Plasma microturbulence simulation of instabilities at highly disparate scales. J. Phys: Conf. Series, 78:012008, 2007.">CWFH07a</a>]</span>,</p></li>
<li><p>clarify <a class="reference download internal" download="" href="../_downloads/1ef69c2267187dc8cfbc394d28ff8a6f/etg_prl_comment.pdf"><code class="xref download docutils literal notranslate"><span class="pre">errors</span> <span class="pre">made</span> <span class="pre">in</span> <span class="pre">previous</span> <span class="pre">PIC</span> <span class="pre">simulations</span> <span class="pre">of</span> <span class="pre">ETG</span> <span class="pre">turbulence</span></code></a> .</p></li>
</ul>
<p>The first systematic studies of gyrokinetic momentum transport <span id="id57">[<a class="reference internal" href="../zreferences.html#id127" title="R.E. Waltz, G.M. Staebler, J. Candy, and F.L. Hinton. Gyrokinetic theory and simulation of angular momentum transport. Phys. Plasmas, 14:122507, 2007.">WSCH07</a>]</span>, including the effects of the angular momentum pinch from <span class="math notranslate nohighlight">\(\mathbf{E}\times\mathbf{B}\)</span> shear as well as the coriolis pinch, were published, and the effect of plasma shape on <span class="math notranslate nohighlight">\(\mathbf{E}\times\mathbf{B}\)</span> shear quenching and transport was studied <span id="id58">[<a class="reference internal" href="../zreferences.html#id81" title="J.E. Kinsey, R.E. Waltz, and J. Candy. The effect of plasma shaping on turbulent transport and E×B shear quenching in nonlinear gyrokinetic simulations. Phys. Plasmas, 14:102306, 2007.">KWC07</a>]</span>.</p>
</section>
<section id="id59">
<h3>2008<a class="headerlink" href="#id59" title="Permalink to this heading"></a></h3>
<p>The next step in the validation of GYRO was also begun, with the development and application of synthetic BES and CECE diagnostics to allow direct comparisons of GYRO fluctuation predictions against DIII-D core turbulence measurements.  The initial results have been presented at a number of conferences and published in multiple journals <span id="id60">[<a class="reference internal" href="../zreferences.html#id62" title="C. Holland, J. Candy, R.E Waltz, A.E. White, G.R. McKee, M.W. Shafer, L. Schmitz, and G.R Tynan. Validating simulations of core tokamak turbulence: current status and future directions. J. Phys: Conf. Series, 125:012043, 2008.">HCW+08</a>, <a class="reference internal" href="../zreferences.html#id133" title="A.E. White, L. Schmitz, G.R. McKee, C. Holland, W.A. Peebles, T.A. Carter, M.W. Shafer, M.E. Austin, K.H. Burrell, J. Candy, and others. Measurements of core electron temperature and density fluctuations in DIII-D and comparison to nonlinear gyrokinetic simulations. Phys. Plasmas, 15(5):056116, 2008.">WSM+08</a>]</span>.  The initial study focused upon modeling a steady, MHD-free L-mode DIII-D discharge, with the primary conclusions that:</p>
<ol class="arabic simple">
<li><p>Using local, fixed-gradient simulations, GYRO could match the <em>experimental</em> (as calculated via a ONETWO power balance analysis) energy flows within experimental gradient uncertainties for <span class="math notranslate nohighlight">\(r/a &lt; 0.6\)</span> (where <span class="math notranslate nohighlight">\(r/a\)</span> denotes normalized toroidal flux), but systematically underpredicted the energy flow at larger radii.</p></li>
<li><p>When the effects of the synthetic diagnostics were included, local GYRO simulations also accurately reproduced measured fluctuation spectra and correlation lengths at <span class="math notranslate nohighlight">\(r/a = 0.5\)</span>, but underpredicted the measured fluctuation amplitudes at <span class="math notranslate nohighlight">\(r/a = 0.75\)</span> by an amount consistent with the underprediction of the energy fluxes.  Interestingly, the shapes of the spectra and the correlation functions were still accurately reproduced at <span class="math notranslate nohighlight">\(r/a = 0.75\)</span>.</p></li>
</ol>
<p>What the source of the energy flow underprediction is, why the correlation functions and spectral shapes but not amplitudes are accurately predicted at <span class="math notranslate nohighlight">\(r/a = 0.75\)</span>, and whether these results hold for other experimental conditions remain open questions under active investigation at this time.</p>
<p>More results related to gyrokinetic turbulent heating <span id="id61">[<a class="reference internal" href="../zreferences.html#id128" title="R.E. Waltz and G.M. Staebler. Gyrokinetic theory and simulation of turbulent energy exchange. Phys. Plasmas, 15:014505, 2008.">WS08</a>]</span> were published, and a study of GAMs in the context of the drift-wave-zonal-flow paradigm was carried out <span id="id62">[<a class="reference internal" href="../zreferences.html#id129" title="R.E. Waltz and C. Holland. Numerical experiments on the drift wave-zonal flow paradigm for nonlinear saturation. Phys. Plasmas, 15:122503, 2008.">WH08</a>]</span> showing that it applies equally well to long-wavelength ITG/TEM and short-wavelength ETG turbulence.</p>
<p>Significant progress on <strong>neoclassical</strong> and <strong>steady-state transport physics</strong> was also made; these lines of research have a separate wiki.</p>
</section>
<section id="id63">
<h3>2009<a class="headerlink" href="#id63" title="Permalink to this heading"></a></h3>
<p>Researchers from MIT were able to demonstrate good agreement between GYRO and C-Mod experiment via synthetic PCI diagnostics <span id="id64">[<a class="reference internal" href="../zreferences.html#id90" title="L. Lin, M. Porkolab, E.M. Edlund, J.C. Rost, C.L. Fiore, M. Greenwald, Y. Lin, D.R. Mikkelsen, N. Tsujii, and S J. Wukitch. Studies of turbulence and transport in Alcator C-Mod H-mode plasmas with phase contrast imaging and comparisons with GYRO. Phys. Plasmas, 16:012502, 2009.">LPE+09</a>]</span>.</p>
</section>
</section>
<section id="a-computational-science-and-user-perspective">
<h2>A Computational Science and User Perspective<a class="headerlink" href="#a-computational-science-and-user-perspective" title="Permalink to this heading"></a></h2>
<p>GYRO owes it’s computational efficiency in part to the strong support from the ORNL Center for Computational Science (CCS).  GYRO runs well on a wide range of small clusters to large supercomputers.  One can move between platforms seamlessly by setting a <strong>single environment variable</strong>.  GYRO was among the earliest applications ported to the Cray X1 and XT3 at ORNL.  The code is modular and the layout is carefully organized.  There are few uses of esoteric language features.  Initial X1 optimizations to take advantage of multistreaming and vectorization were quite successful for all but the collision operator.  A later effort to improve the performance on the collision operator yielded a factor-of-ten improvement on the X1, with an average 10% improvement on IBM and commodity systems.  Recent PERC data is available which analyzes GYRO performance on various HPC systems <span id="id65">[<a class="reference internal" href="../zreferences.html#id134" title="P. Worley, J. Candy, L. Carrington, K. Huck, T. Kaiser, G. Mahinthakumar, A. Maloney, S. Moore, D. Reed, P. Roth, H. Shan, S. Shende, A. Snavely, S. Sreepathi, F. Wolf, and Y. Zhang. Performance analysis of gyro: a tool evaluation. In Proceedings of the 2005 SciDAC Conference, San Francisco, CA, June 26-30. 2005.">WCC+05</a>]</span> using the IPM, KOJAK, SvPablo, TAU and PMaC modeling tool suite.  Additional GYRO performance data on various systems (including the Cray X1, XD1 and XT3) has been presented by Vetter <span id="id66">[<a class="reference internal" href="../zreferences.html#id109" title="J.S. Vetter, S. Alam, Jr. T.H. Dunigan, M.R. Fahey, P.C. Roth, and P. Worley. Early evaluation of the cray xt3 at ornl. In Proceedings of the 47th Cray User Group Conference, Knoxville, TN, May 16-19. 2005.">VATHD+05</a>]</span>, Worley <span id="id67">[<a class="reference internal" href="../zreferences.html#id135" title="P. Worley, S. Alam, Jr. T.H. Dunigan, M.R. Fahey, and J.S. Vetter. Comparative analysis of interprocess communication on the x1, xd1, and xt3. In Proceedings of the 47th Cray User Group Conference, Knoxville, TN, May 16-19. 2005.">WATHD+05</a>]</span> and Fahey <span id="id68">[<a class="reference internal" href="../zreferences.html#id54" title="M.R. Fahey and J. Candy. GYRO: A 5-D gyrokinetic-Maxwell solver. In ACM/IEEE Proceedings of SC2004: High Performance Computing, Networking and Storage (Pittsburgh, PA). 2004.">FC04</a>]</span>.  GYRO is presently so reliable that it is routinely used by ORNL staff to diagnose <em>system hardware and software issues</em>.  For example, chassis interconnect problems on the XD1, filesystem slowdown in the XT3, and memory management issues on the SGI Altix.</p>
<p>From the point of view of <em>utility</em>, the Eulerian codes GS2 and GYRO are set apart from all other codes in the US program in that they have a large (and growing) non-developer users group.  Numerous painstaking simulations of DIII-D, JET, JT60, and NSTX discharges have been made.  R. Bravenec and C. Holland have developed synthetic diagnostic tools to analyze GYRO data.</p>
<p>In addition to many Cyclone-based scans, we maintain a <a class="reference download internal" download="" href="../_downloads/3881d4fcf0de4ae62c476c508fc379e1/gyro-database.pdf"><code class="xref download docutils literal notranslate"><span class="pre">transport</span> <span class="pre">database</span></code></a> containing over 300 well-resolved flux tube simulations based on the GA standard case parameters <span id="id69">[<a class="reference internal" href="../zreferences.html#id117" title="R.E. Waltz, G.M. Staebler, W. Dorland, G.W. Hammett, M. Kotschenreuther, and J.A. Konings. A gyro-landau fluid transport model. Phys. Plasmas, 4:2482, 1997.">WSD+97</a>]</span>.  Nearly all of these give particle and energy transport coefficients for both electrons and ions.  Some also include momentum transport.   Additional scans are continuously being added to the database.  In our view, compiling a database of simulations is a key practical end-product of nonlinear gyrokinetic simulations.  This database provides the benchmarks and validation for the GA advanced gyrofluid transport model TGLF <span id="id70">[<a class="reference internal" href="../zreferences.html#id95" title="G.M. Staebler, J.E. Kinsey, and R.E. Waltz. Gyro-Landau fluid equations for trapped and passing particles. Phys. Plasmas, 12:102508, 2005.">SKW05</a>, <a class="reference internal" href="../zreferences.html#id96" title="G.M. Staebler, J.E. Kinsey, and R.E. Waltz. A theory-based transport model with comprehensive physics. Phys. Plasmas, 14:055909, 2007.">SKW07</a>]</span>.</p>
</section>
<section id="urban-legends">
<h2>Urban Legends<a class="headerlink" href="#urban-legends" title="Permalink to this heading"></a></h2>
<p>The Eulerian codes GS2 and GYRO have had to confront a number
of <a class="reference external" href="http://en.wikipedia.org/wiki/Urban_legend">urban legends</a> mostly in the form of unpublished/unsubstantiated claims circulating within the fusion theory community. These seem to originate from researchers having no first-hand experience with either Eulerian schemes or local simulations.  We number these for future reference.</p>
<section id="ul1-the-local-gyrobohm-limit-of-global-codes-differs-from-local-codes">
<h3>UL1: The local gyroBohm limit of global codes differs from local codes<a class="headerlink" href="#ul1-the-local-gyrobohm-limit-of-global-codes-differs-from-local-codes" title="Permalink to this heading"></a></h3>
<p>This cannot be true.  As <span class="math notranslate nohighlight">\(\rho_*\)</span> vanishes, the transport obtained from a global code reaches a limiting value at a given radial location.  This limiting value (i.e., the gyroBohm scaled limit) is identical to the local simulation result.  This not only provides the physical meaning of a local simulation, but is an important test of validity for local and global codes alike.  GYRO has passed this test repeatedly <span id="id72">[<a class="reference internal" href="../zreferences.html#id27" title="J. Candy, R.E. Waltz, and W. Dorland. The local limit of global gyrokinetic simulations. Phys. Plasmas, 11:L25, 2004. doi:10.1063/1.1695358.">CWD04</a>, <a class="reference internal" href="../zreferences.html#id120" title="R.E. Waltz, J. Candy, and M.N. Rosenbluth. Gyrokinetic turbulence simulation of profile shear stabilization and broken gyrobohm scaling. Phys. Plasmas, 9:1938, 2002.">WCR02</a>]</span>.</p>
</section>
<section id="ul2-full-torus-simulations-are-necessary-to-correctly-compute-the-local-transport">
<h3>UL2: Full torus simulations are necessary to correctly compute the local transport<a class="headerlink" href="#ul2-full-torus-simulations-are-necessary-to-correctly-compute-the-local-transport" title="Permalink to this heading"></a></h3>
<p>DIII-D full-physics simulations which span 1/6th of a torus, 1/3rd of a torus, 1/2 of a torus, and a full torus give transport diffusivities which differ only by few percent <span id="id73">[<a class="reference internal" href="../zreferences.html#id121" title="R.E. Waltz, J. Candy, F.L. Hinton, C. Estrada-Mila, and J.E. Kinsey. Advances in comprehensive simulations of transport in tokamaks. Nucl. Fusion, 45:741, 2005.">WCH+05</a>]</span>. In fact, full-torus simulations are generally wasteful of computer resources.  Global codes which are limited to full torus operation could obtain significantly more accurate results by simulating only a fraction of a torus but operating with a higher number of particles per cell and/or spatial resolution.</p>
</section>
<section id="ul3-eulerian-codes-have-inadequate-velocity-space-resolution">
<h3>UL3: Eulerian codes have inadequate velocity-space resolution<a class="headerlink" href="#ul3-eulerian-codes-have-inadequate-velocity-space-resolution" title="Permalink to this heading"></a></h3>
<p>The truth is in fact quite the opposite.  Published GYRO simulations are always checked for adequate grid convergence by the standard method of grid refinement.  GYRO has a particularly efficient velocity-space discretization scheme which suffers no accuracy loss even when the distribution is nearly discontinuous across the trapped-passing boundary.  We typically use 128 velocity gridpoints per real-space cell.  This is roughly equivalent to 128 particles per cell (PPC) in terms of points where the distribution function is known.  We emphasize that this was, until recently, <strong>significantly more</strong> than that typically used in PIC simulations <a class="footnote-reference brackets" href="#id83" id="id74" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a>.  We have verified that no significant fine-scale structure in the distribution is being ignored or ‘’coarse-grained’’.  Recent GYRO work <span id="id75">[<a class="reference internal" href="../zreferences.html#id30" title="J. Candy and R.E. Waltz. Velocity-space resolution, entropy production and upwind dissipation in Eulerian gyrokinetic simulations. Phys. Plasmas, 13:032310, 2006.">CW06</a>]</span> demonstrates a detailed steady-state balance between production of fluctuations and (numerical) dissipation, thus resolving the <em>entropy paradox</em> in a manner consistent with the picture developed by Krommes <span id="id76">[<a class="reference internal" href="../zreferences.html#id88" title="J.A. Krommes. Thermostatted $\delta f$. Phys. Plasmas, 6:1477, 1999.">Kro99</a>, <a class="reference internal" href="../zreferences.html#id87" title="J.A. Krommes and G. Hu. The role of dissipation in the theory and simulations of homogeneous plasma turbulence, and resolution of the entropy paradox. Phys. Plasmas, 1:3211, 1994.">KH94</a>]</span>.  The numerical dissipation is also shown to be so small that it does not affect the observed transport.</p>
</section>
<section id="ul4-the-parallel-nonlinearity-can-have-a-dramatic-effect-on-the-transport">
<h3>UL4: The parallel nonlinearity can have a dramatic effect on the transport<a class="headerlink" href="#ul4-the-parallel-nonlinearity-can-have-a-dramatic-effect-on-the-transport" title="Permalink to this heading"></a></h3>
<p>This is false for realistic core tokamak parameters.  The so-called parallel nonlinearity (a velocity-space nonlinearity which is formally one order smaller in <span class="math notranslate nohighlight">\(\rho_*\)</span> than other terms in the gyrokinetic equations) is only one of several small terms commonly neglected in the standard operation of gyrokinetic codes.  GYRO has shown <span id="id77">[<a class="reference internal" href="../zreferences.html#id31" title="J. Candy, R.E. Waltz, S.E. Parker, and Y. Chen. Relevance of the parallel nonlinearity in gyrokinetic simulations of tokamak plasmas. Phys. Plasmas, 13:074501, 2006.">CWPC06</a>]</span> that the parallel nonlinearity has no statistically significant effect on the diagnosed transport when <cite>rho_* &lt; 0.01</cite>. Moreover, the parallel nonlinearity has nothing whatsoever to do with the entropy paradox or with producing steady-states of turbulence.  To be clear the parallel nonlinearity (related to the nonlinear Landau damping and to wave-particle trapping) is the physical origin of a small turbulent heating source. GYRO is the first code to diagnostically calculate this heating <span id="id78">[<a class="reference internal" href="../zreferences.html#id60" title="F.L. Hinton and R.E. Waltz. Gyrokinetic turbulent heating. Phys. Plasmas, 13:102301, 2006.">HW06</a>]</span>.</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id79" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id6">1</a><span class="fn-bracket">]</span></span>
<p>Practically speaking, global simulations allow modest profile variation within the simulation domain, where local simulations consider fixed temperature, density, shape, etc.  Even global simulations, however, must enforce the formal restrictions imposed by the gyrokinetic ordering.</p>
</aside>
<aside class="footnote brackets" id="id80" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id13">2</a><span class="fn-bracket">]</span></span>
<p>Here, ITG-ae means ion-temperature-gradient modes with adiabatic electrons.</p>
</aside>
<aside class="footnote brackets" id="id81" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id29">3</a><span class="fn-bracket">]</span></span>
<p>The transition is also dependent on the closeness to marginality <span id="id82">[<a class="reference internal" href="../zreferences.html#id26" title="J. Candy and R.E. Waltz. Anomalous transport scaling in the DIII-D tokamak matched by supercomputer simulation. Phys. Rev. Lett., 91:045001, 2003. doi:10.1103/PhysRevLett.91.045001.">CW03a</a>, <a class="reference internal" href="../zreferences.html#id120" title="R.E. Waltz, J. Candy, and M.N. Rosenbluth. Gyrokinetic turbulence simulation of profile shear stabilization and broken gyrobohm scaling. Phys. Plasmas, 9:1938, 2002.">WCR02</a>]</span>.</p>
</aside>
<aside class="footnote brackets" id="id83" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id74">4</a><span class="fn-bracket">]</span></span>
<p>Since the publication of the Nevins-Hammett theory of PIC noise <span id="id84">[<a class="reference internal" href="../zreferences.html#id91" title="W.M. Nevins, G.W. Hammett, A.M. Dimits, W. Dorland, and D.E. Shumaker. Discrete particle noise in particle-in-cell simulations of plasma microturbulence. Phys. Plasmas, 12:122305, 2005.">NHD+05</a>]</span>, the typical number of particles per cell in PIC simulations seems to have grown, whereas the GYRO resolution has remain unchanged over approximately 6 years and probably over a thousand simulations.</p>
</aside>
</aside>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="gyro_vv.html" class="btn btn-neutral float-left" title="GYRO verification and validation (pre 2010)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="gyro_gallery.html" class="btn btn-neutral float-right" title="Gallery of classic GYRO images (circa 2003)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2010-2023.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>