

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CGYRO &mdash; GACODE 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/contentui.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/custom.css?v=a0fb6060" />

  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=2882ecd3"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/contentui.js"></script>
      <script>window.MathJax = {"tex": {"macros": {"qfilt": "{\\mathcal{Q}}", "exb": "{\\mathbf{E} \\hskip -1pt \\times \\hskip -1pt \\mathbf{B}}", "df": "{\\delta \\hskip -0.5pt f}", "vpar": "{{\\rm v}_\\parallel}", "vta": "{{\\rm v}_{ta}}", "bhat": "{\\textbf{b}}", "dv": "{d^{\\hskip 1pt 3} \\hskip -1pt {\\rm v}}", "jp": "{{\\cal J}_\\psi}", "B": "{\\mathbf{B}}", "bunit": "{B_\\mathrm{unit}}", "betae": "{\\beta_{e,{\\rm unit}}}", "dphi": "{\\delta \\hskip -1pt \\phi}", "dap": "{\\delta \\hskip -1pt A_\\parallel}", "dbp": "{\\delta \\hskip -1pt B_\\parallel}", "dphif": "{\\delta \\hskip -0.5pt \\widetilde{\\phi}}", "dapf": "{\\delta \\hskip -0.5pt \\widetilde{A}_\\parallel}", "dbpf": "{\\delta \\hskip -0.5pt \\widetilde{B}_\\parallel}", "na": "{N_\\alpha}", "nr": "{N_r}", "nx": "{N_\\xi}", "nux": "{N_u}", "nt": "{N_\\theta}", "ux": "{u}", "uxa": "{{\\ux}_a}", "uxb": "{{\\ux}_b}", "kpv": "{{\\bf k}_\\perp}", "md": "{m_\\mathrm{D}}", "Hf": "{\\widetilde{H}_a}", "Hk": "{H_{a,\\kpv}}", "Hkb": "{H_{b,\\kpv}}", "Hfb": "{\\widetilde{H}_b}", "pf": "{\\widetilde{\\Psi}_a}", "rhos": "{\\rho_s}", "hf": "{\\widetilde{h}_a}", "kperp": "{{\\mathbf k}_\\perp}", "qgb": "{Q_\\mathrm{GB}}", "kx": "{k_x^0}", "fwid": "{3.2in}", "nlc": "{\\texttt{nl03}\\xspace}", "rhof": "{\\rho_\\mathrm{f}}"}}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="GYRO" href="gyro.html" />
    <link rel="prev" title="PLOT" href="tgyro/plot.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            GACODE
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="README.html">Using GACODE</a></li>
<li class="toctree-l1"><a class="reference internal" href="setup.html">Prebuilt Environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="build.html">Build on your laptop</a></li>
<li class="toctree-l1"><a class="reference internal" href="zreferences.html">References</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Codes</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="neo.html">NEO</a></li>
<li class="toctree-l1"><a class="reference internal" href="tgyro.html">TGYRO</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">CGYRO</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#brief-description">Brief description</a></li>
<li class="toctree-l2"><a class="reference internal" href="#simulation-images">Simulation images</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cgyro-source-code">CGYRO Source Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="#past-and-future">Past and Future</a></li>
<li class="toctree-l2"><a class="reference internal" href="#data-input">Data input</a></li>
<li class="toctree-l2"><a class="reference internal" href="#data-output-and-plotting">Data output and plotting</a></li>
<li class="toctree-l2"><a class="reference internal" href="#normalization">Normalization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#running-cases">Running Cases</a></li>
<li class="toctree-l2"><a class="reference internal" href="#frequently-asked-questions">Frequently Asked Questions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="gyro.html">GYRO</a></li>
<li class="toctree-l1"><a class="reference internal" href="tglf.html">TGLF</a></li>
<li class="toctree-l1"><a class="reference internal" href="prgen.html">profiles_gen</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Physics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="geometry.html">Flux-Surface Geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="rotation.html">Rotation Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="input_gacode.html">input.gacode</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Misc</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="performance.html">Computational Performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="workshop.html">CGYRO Workshop 2022</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">GACODE</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">CGYRO</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="cgyro">
<h1>CGYRO<a class="headerlink" href="#cgyro" title="Link to this heading"></a></h1>
<section id="brief-description">
<h2>Brief description<a class="headerlink" href="#brief-description" title="Link to this heading"></a></h2>
<p>CGYRO is a global-spectral gyrokinetic code. Core developers are</p>
<ul class="simple">
<li><p>Emily Belli, <a class="reference external" href="https://www.ga.com/">General Atomics</a></p></li>
<li><p>Jeff Candy, <a class="reference external" href="https://www.ga.com/">General Atomics</a></p></li>
<li><p>Klaus Hallatschek, <a class="reference external" href="https://www.ipp.mpg.de/">IPP</a></p></li>
<li><p>Igor Sfiligoi, <a class="reference external" href="https://www.sdsc.edu/">SDSC</a></p></li>
</ul>
</section>
<section id="simulation-images">
<h2>Simulation images<a class="headerlink" href="#simulation-images" title="Link to this heading"></a></h2>
<p>Simulation data courtesy Nathan Howard (MIT)</p>
<a class="reference internal image-reference" href="_images/b250.png"><img alt="b250" src="_images/b250.png" style="width: 48%;" />
</a>
<a class="reference internal image-reference" href="_images/b990.png"><img alt="b990" src="_images/b990.png" style="width: 48%;" />
</a>
<a class="reference internal image-reference" href="_images/b1020.png"><img alt="b1020" src="_images/b1020.png" style="width: 48%;" />
</a>
<a class="reference internal image-reference" href="_images/b1480.png"><img alt="b1480" src="_images/b1480.png" style="width: 48%;" />
</a>
</section>
<section id="cgyro-source-code">
<h2>CGYRO Source Code<a class="headerlink" href="#cgyro-source-code" title="Link to this heading"></a></h2>
<p><a class="reference external" href="http://github.com/gafusion/gacode">CGYRO source code</a>  is available at GitHub.</p>
</section>
<section id="past-and-future">
<h2>Past and Future<a class="headerlink" href="#past-and-future" title="Link to this heading"></a></h2>
<p><strong>The past: GYRO</strong></p>
<p>Over the past two decades, the fusion community has focused its modeling efforts
primarily on the core region. A popular kinetic code used for this purpose
was GYRO <span id="id3">[<a class="reference internal" href="zreferences.html#id189" title="J. Candy and E. Belli. GYRO Technical Guide. General Atomics Technical Report, 2010.">CB10</a>, <a class="reference internal" href="zreferences.html#id178" title="J. Candy and R.E. Waltz. An Eulerian gyrokinetic-Maxwell solver. J. Comput. Phys., 186:545, 2003. doi:doi.org/10.1016/S0021-9991(03)00079-2.">CW03a</a>, <a class="reference internal" href="zreferences.html#id179" title="J. Candy and R.E. Waltz. Anomalous transport in the DIII-D tokamak matched by supercomputer simulation. Phys. Rev. Lett., 91:045001-1, 2003. doi:doi.org/10.1103/PhysRevLett.91.045001.">CW03b</a>, <a class="reference internal" href="zreferences.html#id180" title="J. Candy, R.E. Waltz, and W. Dorland. The local limit of global gyrokinetic simulations. Phys. Plasmas, 11:L25, 2004. doi:doi.org/10.1063/1.1695358.">CWD04</a>]</span>.
Thousands of nonlinear simulations with GYRO have informed the fusion community’s understanding of
core plasma turbulence <span id="id4">[<a class="reference internal" href="zreferences.html#id515" title="N.T. Howard, C. Holland, A.E. White, M. Greenwald, and J. Candy. Multi-scale gyrokinetic simulation of tokamak plasmas: enhanced heat loss due to cross-scale coupling of plasma turbulence. Nucl. Fusion, 56(1):014004, 2016. doi:doi.org/10.1088/0029-5515/56/1/014004.">HHW+16</a>, <a class="reference internal" href="zreferences.html#id597" title="J.E. Kinsey, R.E. Waltz, and J. Candy. Nonlinear gyrokinetic turbulence simulations of E×B shear quenching of transport. Phys. Plasmas, 12:062302, 2005.">KWC05</a>, <a class="reference internal" href="zreferences.html#id598" title="J.E. Kinsey, R.E. Waltz, and J. Candy. The effect of safety factor and magnetic shear on turbulent transport in nonlinear gyrokinetic simulations. Phys. Plasmas, 13:022305, 2006.">KWC06</a>, <a class="reference internal" href="zreferences.html#id599" title="J.E. Kinsey, R.E. Waltz, and J. Candy. The effect of plasma shaping on turbulent transport and E×B shear quenching in nonlinear gyrokinetic simulations. Phys. Plasmas, 14:102306, 2007.">KWC07</a>]</span>
and provided a <em>transport database</em> for the calibration of reduced transport models
such as TGLF <span id="id5">[<a class="reference internal" href="zreferences.html#id1020" title="G.M. Staebler, J.E. Kinsey, and R.E. Waltz. A theory-based transport model with comprehensive physics. Phys. Plasmas, 14:055909, 2007.">SKW07</a>]</span>.  GYRO was the first global electromagnetic solver,
and pioneered the development of numerical algorithms for the GK equations
with kinetic electrons.  It is formulated in real space and like all global solvers
requires <em>ad hoc</em> absorbing-layer boundary conditions when simulating cases
with profile variation.  This approach is suitable for core turbulence simulations,
which cover a large radial region and are dominated by low wavenumbers.</p>
<p><strong>The future: CGYRO</strong></p>
<p>As the understanding of core transport has become increasingly complete, the
cutting edge of research moved radially toward the pedestal region, where plasmas are
characterized by larger collisionality and steeper pressure gradients that
greatly modify the turbulent phenomena at play. This motivated the development,
from scratch, of the CGYRO code <span id="id6">[<a class="reference internal" href="zreferences.html#id87" title="E.A. Belli and J. Candy. Implications of advanced collision operators for gyrokinetic simulation. Plasma Phys. Control. Fusion, 59:045005, 2017. doi:doi.org/10.1088/1361-6587/aa5c94.">BC17</a>, <a class="reference internal" href="zreferences.html#id88" title="E.A. Belli and J. Candy. Impact of centrifugal drifts on ion turbulent transport. Phys. Plasmas, 25:032301, 2018. doi:doi.org/10.1063/1.5020298.">BC18</a>, <a class="reference internal" href="zreferences.html#id193" title="J. Candy, E.A. Belli, and R.V. Bravenec. A high-accuracy Eulerian gyrokinetic solver for collisional plasmas. J. Comput. Phys., 324:73, 2016. doi:doi.org/10.1016/j.jcp.2016.07.039.">CBB16</a>, <a class="reference internal" href="zreferences.html#id195" title="J. Candy, I. Sfiligoi, E. Belli, K. Hallatschek, C. Holland, N. Howard, and E.D`Azevedo. Multiscale-optimized plasma turbulence simulation on petascale architechtures. Computers &amp; Fluids, 188:125, 2019. doi:doi.org/10.1016/j.compfluid.2019.04.016.">CSB+19</a>]</span>
to complement GYRO.  CGYRO is an Eulerian GK solver specifically designed and
optimized for <strong>collisional, electromagnetic, multiscale simulation</strong>.
A key algorithmic aspect of CGYRO is the <strong>radially spectral formulation</strong>
used to reduce the complicated integral gyroaveraging kernel into a
multiplication in wavenumber space, but retaining the ability to treat profile
variation important for edge plasmas <span id="id7">[<a class="reference internal" href="zreferences.html#id194" title="J. Candy and E.A. Belli. Spectral treatment of gyrokinetic shear flow. J. Comput. Phys., 356:448, 2018. doi:doi.org/10.1016/j.jcp.2017.12.020.">CB18</a>, <a class="reference internal" href="zreferences.html#id196" title="J. Candy, E.A. Belli, and G. Staebler. Spectral treatment of gyrokinetic profile curvature. Plasma Phys. Control. Fusion, 62:042001, 2020. doi:doi.org/10.1088/1361-6587/ab759c.">CBS20</a>]</span>.  A new coordinate system that is more
suitable for the highly collisional and shaped edge regime was adopted from
the NEO code <span id="id8">[<a class="reference internal" href="zreferences.html#id79" title="E.A. Belli and J. Candy. Kinetic calculation of neoclassical transport including self-consistent electron and impurity dynamics. Plasma Phys. Control. Fusion, 50:095010, 2008. doi:doi.org/10.1088/0741-3335/50/9/095010.">BC08</a>, <a class="reference internal" href="zreferences.html#id83" title="E.A. Belli and J. Candy. Full linearized Fokker-Planck collisions in neoclassical transport simulations. Plasma Phys. Control. Fusion, 54:015015, 2012. doi:doi.org/10.1088/0741-3335/54/1/015015.">BC12</a>]</span>, which is the community standard for
calculation of collisional transport in toroidal geometry.</p>
</section>
<section id="data-input">
<h2>Data input<a class="headerlink" href="#data-input" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="cgyro/cgyro_table.html"><span class="doc">Tabular list</span></a></p></li>
<li><p><a class="reference internal" href="cgyro/cgyro_list.html"><span class="doc">Alphabetical list</span></a></p></li>
<li><p>Profile data: <a class="reference internal" href="input_gacode.html#input-gacode"><span class="std std-ref">input.gacode</span></a>.</p></li>
</ul>
</section>
<section id="data-output-and-plotting">
<h2>Data output and plotting<a class="headerlink" href="#data-output-and-plotting" title="Link to this heading"></a></h2>
<p>Although there is a description of <a class="reference internal" href="cgyro/outputs.html"><span class="doc">output data</span></a>, it is suggested that users use the python interface to output data.</p>
</section>
<section id="normalization">
<h2>Normalization<a class="headerlink" href="#normalization" title="Link to this heading"></a></h2>
<table class="docutils align-default" id="id9">
<caption><span class="caption-number">Table 18 </span><span class="caption-text"><strong>CGYRO Normalization</strong></span><a class="headerlink" href="#id9" title="Link to this table"></a></caption>
<colgroup>
<col style="width: 33.3%" />
<col style="width: 25.0%" />
<col style="width: 41.7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Quantity</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>length</p></td>
<td><p><span class="math notranslate nohighlight">\(a\)</span></p></td>
<td><p>minor radius</p></td>
</tr>
<tr class="row-odd"><td><p>mass</p></td>
<td><p><span class="math notranslate nohighlight">\(m_\mathrm{D}\)</span></p></td>
<td><p>deuterium mass = <span class="math notranslate nohighlight">\(3.345\times 10^{24} g\)</span></p></td>
</tr>
<tr class="row-even"><td><p>density</p></td>
<td><p><span class="math notranslate nohighlight">\(n_e\)</span></p></td>
<td><p>electron density</p></td>
</tr>
<tr class="row-odd"><td><p>temperature</p></td>
<td><p><span class="math notranslate nohighlight">\(T_e\)</span></p></td>
<td><p>electron temperature</p></td>
</tr>
<tr class="row-even"><td><p>velocity</p></td>
<td><p><span class="math notranslate nohighlight">\(c_s = \sqrt{T_e/m_\mathrm{D}}\)</span></p></td>
<td><p>deuterium sound speed</p></td>
</tr>
<tr class="row-odd"><td><p>time</p></td>
<td><p><span class="math notranslate nohighlight">\(a/c_s\)</span></p></td>
<td><p>minor radius over sound speed</p></td>
</tr>
</tbody>
</table>
</section>
<section id="running-cases">
<h2>Running Cases<a class="headerlink" href="#running-cases" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="cgyro/running_cases.html"><span class="doc">running cases</span></a></p></li>
</ul>
</section>
<section id="frequently-asked-questions">
<h2>Frequently Asked Questions<a class="headerlink" href="#frequently-asked-questions" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="cgyro/FAQ.html"><span class="doc">FAQ</span></a></p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="tgyro/plot.html" class="btn btn-neutral float-left" title="PLOT" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="gyro.html" class="btn btn-neutral float-right" title="GYRO" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2000-2025.
      <span class="lastupdated">Last updated on Apr 27, 2025.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>