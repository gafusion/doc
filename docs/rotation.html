<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PLASMA ROTATION THEORY &mdash; GACODE</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/contentui.css?v=4cf5b151" />

  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=5929fcd5"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="_static/contentui.js?v=9ee86694"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="input.gacode" href="input_gacode.html" />
    <link rel="prev" title="FLUX-SURFACE GEOMETRY" href="geometry.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            GACODE
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Software</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="license.html">GACODE License</a></li>
<li class="toctree-l1"><a class="reference internal" href="download.html">Download and user agreement</a></li>
<li class="toctree-l1"><a class="reference internal" href="setup.html">Environment setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="build.html">Build from sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="zreferences.html">References</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Codes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="neo.html">NEO</a></li>
<li class="toctree-l1"><a class="reference internal" href="tgyro.html">TGYRO</a></li>
<li class="toctree-l1"><a class="reference internal" href="cgyro.html">CGYRO</a></li>
<li class="toctree-l1"><a class="reference internal" href="gyro.html">GYRO</a></li>
<li class="toctree-l1"><a class="reference internal" href="tglf.html">TGLF</a></li>
<li class="toctree-l1"><a class="reference internal" href="prgen.html">profiles_gen</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Physics</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="geometry.html">FLUX-SURFACE GEOMETRY</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">PLASMA ROTATION THEORY</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#physical-considerations">Physical considerations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sonic-rotation-formalism">Sonic rotation formalism</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-rotation-profile">The rotation profile</a></li>
<li class="toctree-l2"><a class="reference internal" href="#input-parameters">Input parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#theoretical-basis-for-sonic-rotation">Theoretical basis for sonic rotation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#connection-to-experimental-data">Connection to experimental data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#consistency-with-force-balance">Consistency with force balance</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="input_gacode.html">input.gacode</a></li>
<li class="toctree-l1"><a class="reference internal" href="misc.html">Miscellaneous</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">GACODE</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">PLASMA ROTATION THEORY</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/rotation.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="plasma-rotation-theory">
<h1>PLASMA ROTATION THEORY<a class="headerlink" href="#plasma-rotation-theory" title="Link to this heading"></a></h1>
<section id="physical-considerations">
<h2>Physical considerations<a class="headerlink" href="#physical-considerations" title="Link to this heading"></a></h2>
<p>Sonic rotation can arise in tokamaks from torque due to neutral beam injection.  It is believed to play an important role in the suppression of turbulence and the formation of transport barriers through <span class="math notranslate nohighlight">\(\mathbf{E}\times\mathbf{B}\)</span> shear.  In addition, it produces a strong centrifugal force that pushes ions toroidally outward, causing them to redistribute nonuniformly around a flux surface.  As a result of quasi-neutrality, a poloidally-varying electrostatic potential is generated by the electrons to balance the density asymmetry.  This generates <strong>centrifugal drifts</strong> in addition to the usual <span class="math notranslate nohighlight">\(\mathbf{E}\times\mathbf{B}\)</span> rotation, Coriolis drift, and parallel velocity shear. Because of their complexity, these centrifugal effects, which are second-order in the main ion Mach number, are ignored in most neoclassical and gyrokinetic codes.  Inclusion of full sonic rotation effects is particularly critical for studying transport of heavy impurities <span id="id1">[<a class="reference internal" href="zreferences.html#id13" title="E.A. Belli and J. Candy. Kinetic calculation of neoclassical transport including self-consistent electron and impurity dynamics. Plasma Phys. Control. Fusion, 50:095010, 2008. doi:10.1088/0741-3335/50/9/095010.">BC08</a>]</span>, as the influence of the centrifugal force is amplified by their large mass.</p>
</section>
<section id="sonic-rotation-formalism">
<h2>Sonic rotation formalism<a class="headerlink" href="#sonic-rotation-formalism" title="Link to this heading"></a></h2>
<p>The rigorous derivation of the gyrokinetic equations for sonic rotation was carried out by Sugama <span id="id2">[<a class="reference internal" href="zreferences.html#id110" title="H. Sugama and W. Horton. Nonlinear electromagnetic gyrokinetic equation for plasmas with large mean flows. Phys. Plasmas, 5:2560, 1998.">SH98</a>]</span>.  Sugama followed the underlying rotation formulation of Hinton and Wong <span id="id3">[<a class="reference internal" href="zreferences.html#id60" title="F.L. Hinton and S.K. Wong. Neoclassical ion transport in rotating axisymmetric plasmas. Phys. Fluids, 28:3082, 1985. doi:10.1063/1.865350.">HW85</a>]</span>, who showed that in an axisymmetric system the zeroth-order flow velocity is</p>
<div class="math notranslate nohighlight">
\[\mathbf{U}_0 = \omega_0(\psi) R^2 \nabla \varphi \; .\]</div>
<p>It is this scalar flux-function, <span class="math notranslate nohighlight">\(\omega_0\)</span>, that is the true free (input) function in both neoclassical and gyrokinetic theory.  Here, <span class="math notranslate nohighlight">\(\psi\)</span> is the poloidal flux.</p>
</section>
<section id="the-rotation-profile">
<h2>The rotation profile<a class="headerlink" href="#the-rotation-profile" title="Link to this heading"></a></h2>
<p>The relevant profile that gives a <em>complete specification of rotation</em> is the angular frequency <span class="math notranslate nohighlight">\(\omega_0(r)\)</span>, which in defined consistently throughout GACODE as</p>
<div class="math notranslate nohighlight">
\[\omega_0(r) \longrightarrow \frac{c E_r }{R B_p} \; .\]</div>
<p>Thus, if the <span class="math notranslate nohighlight">\(E_r\)</span> is known from a priori analysis (say, through velocity measurements and force balance), then <span class="math notranslate nohighlight">\(\omega_0\)</span> is given by the formula above.  This equality is subtle (hence the reason for the arrow rather than an equality) and is clarified in detail in the last section.</p>
</section>
<section id="input-parameters">
<h2>Input parameters<a class="headerlink" href="#input-parameters" title="Link to this heading"></a></h2>
<p>CGYRO and NEO implement <em>full sonic rotation</em> (GYRO implements only a reduced model) according to the formulation of Hinton and Wong <span id="id4">[<a class="reference internal" href="zreferences.html#id60" title="F.L. Hinton and S.K. Wong. Neoclassical ion transport in rotating axisymmetric plasmas. Phys. Fluids, 28:3082, 1985. doi:10.1063/1.865350.">HW85</a>]</span>.  Neoclassically, the induced poloidally-varying electrostatic potential leads to the formation of potential wells.  In the banana regime these increase the effective trapped particle fraction, and in the Pfirsh-Schlüter regime increase the effective toroidal curvature.  In both instances, this may lead to enhanced neoclassical transport.  The code inputs are given in the tables below.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Note that all the inputs are derived from the single free function, <span class="math notranslate nohighlight">\(\omega_0\)</span>.</p>
</div>
<table class="docutils align-default">
<colgroup>
<col style="width: 25.0%" />
<col style="width: 37.5%" />
<col style="width: 37.5%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>input.cgyro parameter</p></th>
<th class="head"><p>Definition</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="cgyro/cgyro_list.html#cgyro-gamma-e"><span class="std std-ref">GAMMA_E</span></a></p></td>
<td><p><span class="math notranslate nohighlight">\(\displaystyle \frac{a}{c_s} \, \gamma_{\rm E} \doteq -\frac{r}{q}\frac{d \omega_{0}}{d r}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\mathbf{E}\times\mathbf{B}\)</span> shearing rate</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="cgyro/cgyro_list.html#cgyro-gamma-p"><span class="std std-ref">GAMMA_P</span></a></p></td>
<td><p><span class="math notranslate nohighlight">\(\displaystyle \frac{a}{c_s} \, \gamma_p \doteq -R_0\frac{d \omega_{0}}{d r}\)</span></p></td>
<td><p>rotation shearing rate</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="cgyro/cgyro_list.html#cgyro-mach"><span class="std std-ref">MACH</span></a></p></td>
<td><p><span class="math notranslate nohighlight">\(\displaystyle M \doteq \frac{\omega_0 R_0}{c_s}\)</span></p></td>
<td><p>rotation rate</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 25.0%" />
<col style="width: 37.5%" />
<col style="width: 37.5%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>input.neo parameter</p></th>
<th class="head"><p>Definition</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="neo/neo_list.html#neo-omega-rot"><span class="std std-ref">OMEGA_ROT</span></a></p></td>
<td><p><span class="math notranslate nohighlight">\(\displaystyle  \frac{a}{v_{norm}} \omega_0\)</span></p></td>
<td><p>rotation rate</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="neo/neo_list.html#neo-omega-rot-deriv"><span class="std std-ref">OMEGA_ROT_DERIV</span></a></p></td>
<td><p><span class="math notranslate nohighlight">\(\displaystyle \frac{a^{2}}{v_{norm}} \frac{d \omega_{0}}{dr}\)</span></p></td>
<td><p>derivative of rotation rate</p></td>
</tr>
</tbody>
</table>
</section>
<section id="theoretical-basis-for-sonic-rotation">
<h2>Theoretical basis for sonic rotation<a class="headerlink" href="#theoretical-basis-for-sonic-rotation" title="Link to this heading"></a></h2>
<p>In presence of rapid rotation, where the flow speed <span class="math notranslate nohighlight">\(U\)</span> is allowed to be of the order of the ion thermal speed, the Lorentz
force term in the the Fokker-Planck equation (see <span id="id5">[<a class="reference internal" href="zreferences.html#id60" title="F.L. Hinton and S.K. Wong. Neoclassical ion transport in rotating axisymmetric plasmas. Phys. Fluids, 28:3082, 1985. doi:10.1063/1.865350.">HW85</a>]</span>)</p>
<div class="math notranslate nohighlight">
\[\frac{\partial f_i}{\partial t} + \mathbf{v} \cdot \nabla f_i + \frac{e}{m_i}(\mathbf{E}+\mathbf{v} \times \mathbf{B})
\cdot \frac{\partial f_i}{\partial \mathbf{v}} = C_i + S_i\]</div>
<p>becomes the leading term.  Under these circumstances Hinton and Wong show that</p>
<div class="math notranslate nohighlight">
\[\mathbf{E}_{-1} + \frac{\mathbf{U}_0}{c} \times \mathbf{B} = 0 \; ,\]</div>
<p>where the subscripts represents the order with respect to the <strong>drift ordering</strong> in <span class="math notranslate nohighlight">\(\rho_i/a\)</span>.
Here <span class="math notranslate nohighlight">\(\mathbf{U}_0\)</span> is a purely toroidal velocity and is species independent.  This ordering is applied to
all fields and moments</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{matrix}
f_i        &amp; = &amp;           &amp;   &amp; f_{i,0}       &amp; + &amp; f_{i,1}       &amp; + &amp; \ldots \\
\Phi       &amp; = &amp; \Phi_{-1} &amp; + &amp; \Phi_0        &amp; + &amp; \Phi_1        &amp; + &amp; \ldots \\
\mathbf{U} &amp; = &amp;           &amp;   &amp; \mathbf{U}_0  &amp; + &amp; \mathbf{U}_1  &amp; + &amp; \ldots \\
U_\varphi  &amp; = &amp;           &amp;   &amp; U_{\varphi,0} &amp; + &amp; U_{\varphi,1} &amp; + &amp; \ldots \\
U_\theta   &amp; = &amp;           &amp;   &amp;               &amp;   &amp; U_{\theta,1}  &amp; + &amp; \ldots
\end{matrix}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(U_\varphi \doteq \mathbf{e}_\varphi \cdot \mathbf{U}\)</span> is the <em>toroidal velocity</em> and <span class="math notranslate nohighlight">\(U_\theta \doteq \mathbf{e}_\theta \cdot \mathbf{U}\)</span> is the <em>poloidal velocity</em>.  The leading-order sonic flow is toroidal and independent of species</p>
<div class="math notranslate nohighlight">
\[\mathbf{U}_0 = \omega_0(\psi) R \mathbf{e}_{\varphi} \quad \text{where} \quad
\omega_{0}(\psi) \doteq -c \frac{d \Phi_{-1}}{d \psi} \; .\]</div>
<p>It is important to note that <span class="math notranslate nohighlight">\(\Phi_{-1}\)</span> is a <strong>flux function</strong>, whereas higher orders are not constant on a flux surface.</p>
</section>
<section id="connection-to-experimental-data">
<h2>Connection to experimental data<a class="headerlink" href="#connection-to-experimental-data" title="Link to this heading"></a></h2>
<p>We remark that <span class="math notranslate nohighlight">\(\omega_{0}\)</span> is a <strong>theoretical quantity</strong> that cannot be measured in the experiment.  This is similar
to the observation that the experimentally-measured temperature <span class="math notranslate nohighlight">\(T_i\)</span> is really the sum of an <em>equilibrium temperature</em> and a small <em>fluctuating temperature</em> driven by turbulence: <span class="math notranslate nohighlight">\(T_i = T_{i0} + T_{i1}\)</span>.  If the drift ordering is valid, then we are justified in approximating the equilibrium temperature <span class="math notranslate nohighlight">\(T_{i0}\)</span> by the measured temperature <span class="math notranslate nohighlight">\(T_i\)</span>.
For the rotation frequency, similar considerations hold.  We note that the theory shows that the potential always appears in the combination</p>
<div class="math notranslate nohighlight">
\[\Phi_{-1} + \left\langle \Phi_0 \right\rangle \; ,\]</div>
<p>where an angle bracket denotes a flux-surface average.  By analogy with the temperature, the rotation frequency can related to the experimentally-deduced radial electric field <span class="math notranslate nohighlight">\(E_r\)</span>, where <span class="math notranslate nohighlight">\(E_r = -|\nabla r| d\Phi/dr\)</span>, according to</p>
<div class="math notranslate nohighlight">
\[\omega_0 + \omega_1 \simeq  \frac{c E_r}{R B_p} \quad\text{where}\quad \omega_1 \doteq -c \frac{d  \left\langle \Phi_0 \right\rangle }{d\psi} \; .\]</div>
<p>In practice, we can set <span class="math notranslate nohighlight">\(\omega_1 = 0\)</span> <em>without loss of generality</em> and all the rotation is contained in <span class="math notranslate nohighlight">\(\omega_0\)</span>.
Alternatively, in the diamagnetic rotation limit, we set <span class="math notranslate nohighlight">\(\omega_0 = 0\)</span> with the rotation contained in <span class="math notranslate nohighlight">\(\omega_1\)</span>.  The present theory works consistently in both cases.  Finally, the toroidal velocities <span class="math notranslate nohighlight">\(U_{\varphi,0} + U_{\varphi,1}\)</span> are treated in the same way.</p>
</section>
<section id="consistency-with-force-balance">
<h2>Consistency with force balance<a class="headerlink" href="#consistency-with-force-balance" title="Link to this heading"></a></h2>
<p>In experimental analyses the <em>radial force balance</em> relation is often used</p>
<div class="math notranslate nohighlight">
\[E_r = \frac{R B_p}{n_a z_a e} \frac{d p_a}{d\psi} + \frac{U_\varphi}{c} B_p - \frac{U_\theta}{c} B_t \; .\]</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>We emphasize that this relation is <em>valid at long wavelength (equilibrium scales) only</em>, and is subject to the same ordering requirements as standard neoclassical and gyrokinetic theory.  This means a restriction on the steepness of gradients in the form <span class="math notranslate nohighlight">\(d \ln p/dr \ll 1/\rho_i\)</span>.  See, for example, the discussion in <span id="id6">[<a class="reference internal" href="zreferences.html#id114" title="H. Sugama, T.-H. Watanabe, M. Nunami, and S. Nishimura. Momentum balance and radial electric fields in axisymmetric and nonaxisymmetric toroidal plasmas. Plasma Phys. Control. Fusion, 53:024004, 2011.">SWNN11</a>]</span>.</p>
</div>
<p>The force balance relation contains terms of order 0 and 1, as described in the previous sections.  We can write the velocities in terms of the neoclassical flow coefficient <span class="math notranslate nohighlight">\(K_a\)</span> (see <span id="id7">[<a class="reference internal" href="zreferences.html#id15" title="E.A. Belli and J. Candy. An Eulerian method for the solution of the multi-species drift-kinetic equation. Plasma Phys. Control. Fusion, 51:075018, 2009.">BC09</a>]</span>) as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
U_\varphi = &amp;~ \frac{K_a}{n_a} B_t + \omega_{1,a} R + \omega_0 R \; , \\
U_\theta = &amp;~ \frac{K_a}{n_a} B_p \; .
\end{align}\end{split}\]</div>
<p>In the expression for <span class="math notranslate nohighlight">\(U_\varphi\)</span>, we have defined the angular frequencies</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\omega_{1,a} = &amp;~ -c \frac{d \left\langle\Phi_0\right\rangle}{d\psi} -
\frac{c}{n_a z_a e}  \frac{d p_a}{d\psi} + {\cal O}(M^2) \; , \\
\omega_0     = &amp;~ -c \frac{d \Phi_{-1} }{d\psi} \; .
\end{align}\end{split}\]</div>
<p>Substitution of the neoclassical flows into the force balance relation shows that <strong>all species-dependent terms cancel</strong>, leaving</p>
<div class="math notranslate nohighlight">
\[E_r = \frac{R B_p}{c} \left( \omega_0 + \omega_1 \right) \; ,\]</div>
<p>where the species-independent frequency <span class="math notranslate nohighlight">\(\omega_1\)</span> is discussed in the previous section.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="geometry.html" class="btn btn-neutral float-left" title="FLUX-SURFACE GEOMETRY" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="input_gacode.html" class="btn btn-neutral float-right" title="input.gacode" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2010-2024.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>